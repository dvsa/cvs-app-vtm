<section class="govuk-grid-row">
  <app-accordion-control [class]="'padding'" [sectionState]="sectionTemplateState">
    <div class="govuk-grid-column-one-half">
      <ng-container *ngFor="let section of sectionTemplates; let i = index">
        <app-accordion *ngIf="i < middleIndex" [id]="section.name" [title]="section.label" [isExpanded]="isSectionExpanded(section.name)">
          <ng-template [ngTemplateOutlet]="accordion" [ngTemplateOutletContext]="{ sectionName: section.name, section: section }"></ng-template>
        </app-accordion>
      </ng-container>
    </div>
    <div class="govuk-grid-column-one-half">
      <ng-container *ngFor="let section of sectionTemplates; let i = index">
        <app-accordion *ngIf="i >= middleIndex" [id]="section.name" [title]="section.label">
          <ng-template [ngTemplateOutlet]="accordion" [ngTemplateOutletContext]="{ sectionName: section.name, section: section }"></ng-template>
        </app-accordion>
      </ng-container>
    </div>
  </app-accordion-control>
</section>

<ng-template #accordion let-sectionName="sectionName" let-section="section">
  <ng-container [ngSwitch]="sectionName">
    <app-body
      *ngSwitchCase="'bodySection'"
      [techRecord]="techRecordCalculated"
      [isEditing]="isEditing"
      (formChange)="handleFormState($event)"
    ></app-body>

    <app-dimensions
      *ngSwitchCase="'dimensionsSection'"
      [vehicleTechRecord]="techRecordCalculated"
      [isEditing]="isEditing"
      (formChange)="handleFormState($event)"
    ></app-dimensions>

    <app-psv-brakes
      *ngSwitchCase="'psvBrakesSection'"
      [vehicleTechRecord]="techRecordCalculated"
      [isEditing]="isEditing"
      (formChange)="handleFormState($event)"
    ></app-psv-brakes>

    <app-trl-brakes
      *ngSwitchCase="'trlBrakesSection'"
      [vehicleTechRecord]="techRecordCalculated"
      [isEditing]="isEditing"
      (formChange)="handleFormState($event)"
    ></app-trl-brakes>

    <app-tyres
      *ngSwitchCase="'tyreSection'"
      [vehicleTechRecord]="techRecordCalculated"
      [isEditing]="isEditing"
      (formChange)="handleFormState($event)"
    ></app-tyres>

    <app-weights
      *ngSwitchCase="'weightsSection'"
      [vehicleTechRecord]="techRecordCalculated"
      [isEditing]="isEditing"
      (formChange)="handleFormState($event)"
    ></app-weights>

    <app-letters
      *ngSwitchCase="'lettersSection'"
      [techRecord]="techRecordCalculated"
      [isEditing]="isEditing"
      (formChange)="handleFormState($event)"
    ></app-letters>

    <app-plates
      *ngSwitchCase="'platesSection'"
      [techRecord]="techRecordCalculated"
      [isEditing]="isEditing"
      (formChange)="handleFormState($event)"
    ></app-plates>

    <app-dynamic-form-group
      *ngSwitchDefault
      [data]="techRecordCalculated"
      [template]="section"
      [edit]="isEditing"
      (formChange)="handleFormState($event)"
    ></app-dynamic-form-group>
  </ng-container>
</ng-template>
