@if (techRecordEdited && techRecordChanges && vehicleType) {
  <app-banner>
    <ng-container title>Important</ng-container>
    <ng-container content>Check your changes before submitting the technical record</ng-container>
  </app-banner>
  <app-icon [icon]="techRecordEdited.techRecord_vehicleType || ''"></app-icon>
  <app-dynamic-form-group [data]="techRecordEdited" [template]="vehicleSummary"></app-dynamic-form-group>
  <app-accordion-control [class]="'padding'" [sectionState]="sectionTemplatesState$ | async">
    @for (section of customVehicleTemplate; track section; let i = $index) {
      <app-accordion [id]="section.name" [title]="section.label" [isExpanded]="isSectionExpanded$(section.name) | async">
        <ng-template [ngTemplateOutlet]="accordion" [ngTemplateOutletContext]="{ sectionName: section.name, section: section }"></ng-template>
      </app-accordion>
    }
  </app-accordion-control>
  <ng-template #accordion let-sectionName="sectionName" let-section="section">
    @switch (sectionName) {
      @case ('bodySection') {
        <app-body [techRecord]="techRecordEdited" [disableLoadOptions]="true"></app-body>
      }
      @case ('dimensionsSection') {
        @if (
          techRecordEdited.techRecord_vehicleType === 'hgv' ||
          techRecordEdited.techRecord_vehicleType === 'psv' ||
          techRecordEdited.techRecord_vehicleType === 'trl'
          ) {
          <app-dimensions
            [techRecord]="techRecordEdited"
          ></app-dimensions>
        }
      }
      @case ('approvalSection') {
        @if (
          techRecordEdited.techRecord_vehicleType === 'hgv' ||
          techRecordEdited.techRecord_vehicleType === 'psv' ||
          techRecordEdited.techRecord_vehicleType === 'trl'
          ) {
          <app-approval-type [techRecord]="techRecordEdited"></app-approval-type>
        }
      }
      @case ('psvBrakesSection') {
        @if (techRecordEdited.techRecord_vehicleType === 'psv') {
          <app-psv-brakes [vehicleTechRecord]="techRecordEdited"></app-psv-brakes>
        }
      }
      @case ('trlBrakesSection') {
        @if (techRecordEdited.techRecord_vehicleType === 'trl') {
          <app-trl-brakes [vehicleTechRecord]="techRecordEdited"></app-trl-brakes>
        }
      }
      @case ('tyreSection') {
        @if (
          techRecordEdited.techRecord_vehicleType === 'hgv' ||
          techRecordEdited.techRecord_vehicleType === 'psv' ||
          techRecordEdited.techRecord_vehicleType === 'trl'
          ) {
          <app-tyres [vehicleTechRecord]="techRecordEdited"></app-tyres>
        }
      }
      @case ('weightsSection') {
        @if (
          techRecordEdited.techRecord_vehicleType === 'hgv' ||
          techRecordEdited.techRecord_vehicleType === 'psv' ||
          techRecordEdited.techRecord_vehicleType === 'trl'
          ) {
          @if (deletedAxles.length > 0) {
            <div class="govuk-warning-text">
              <span class="govuk-warning-text__icon" aria-hidden="true">!</span>
              <strong class="govuk-warning-text__text">
                <span class="govuk-warning-text__assistive">Warning</span>
                You removed an axle.
              </strong>
            </div>
            <app-weights [vehicleTechRecord]="techRecordEdited"></app-weights>
          } @else {
            @if (changesForWeights) {
              <app-modified-weights [vehicleType]="vehicleType" [changes]="changesForWeights"></app-modified-weights>
            }
          }
        }
      }
      @case ('adrSection') {
        @if (
          techRecordEdited.techRecord_vehicleType === 'hgv' ||
          techRecordEdited.techRecord_vehicleType === 'trl' ||
          techRecordEdited.techRecord_vehicleType === 'lgv'
          ) {
          <app-adr [techRecord]="techRecordEdited" [isReviewScreen]="true"></app-adr>
        }
      }
      @default {
        <app-dynamic-form-group [data]="techRecordChanges" [template]="section"></app-dynamic-form-group>
      }
    }
  </ng-template>
}

<app-button-group>
  <app-button [id]="'submit'" (clicked)="submit()">Submit</app-button>
  <app-button [id]="'cancel'" design="link" (clicked)="cancel()">Cancel</app-button>
</app-button-group>
